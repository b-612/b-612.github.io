{"version":3,"sources":["reg-form.js"],"names":["ANIMATION_TIME","$form","$","setPrevElems","Element","MESSAGE","document","createElement","FURTHER_ACTIONS","TEXT_WRAPPER","addClass","attr","editAndPushElements","elements","messageText","furtherText","text","append","window","util","fragment","fadeIn","onTryBtnClick","$removingElements","$startElements","fadeOut","remove","reset","removeAttr","setTryBtnCallback","click","showMessage","icon","removeClass","onSendSuccess","$icon","onSendError","onSubmitSend","$container","startHeight","height","$startContent","children","progressIcon","SendParam","URL","METHOD","TIMEOUT","ON_SUCCESS","ON_ERROR","onFormSubmit","sendParams","formData","serializeArray","ajax","url","method","timeout","data","dataType","success","error","validateForm","jQuery","validator","addMethod","value","element","test","validate","errorElement","errorClass","rules","name","required","minlength","phone","checkMask","messages","mask","autoclear","setSubmitCallback","on","evt","preventDefault","val","invalidObj","invalid","isObjElem","Object","keys"],"mappings":"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","sourcesContent":["'use strict';\n\n(function () {\n  const ANIMATION_TIME = 300;\n\n  const $form = $('.registration__form');\n\n  const setPrevElems = () => {\n    const Element = {\n      MESSAGE: document.createElement('span'),\n      FURTHER_ACTIONS: document.createElement('button'),\n      TEXT_WRAPPER: document.createElement('div')\n    };\n\n    $(Element.MESSAGE).addClass('registration__message');\n    $(Element.FURTHER_ACTIONS).addClass('registration__further-actions')\n      .attr('type', 'button');\n    $(Element.TEXT_WRAPPER).addClass('registration__message-text-wrapper');\n\n    return Element;\n  };\n\n  const editAndPushElements = (elements, messageText, furtherText) => {\n    $(elements.MESSAGE).text(messageText);\n    $(elements.FURTHER_ACTIONS).text(furtherText);\n    elements.TEXT_WRAPPER.append(elements.MESSAGE);\n    elements.TEXT_WRAPPER.append(elements.FURTHER_ACTIONS);\n    window.util.fragment.append(elements.TEXT_WRAPPER);\n    $('.registration .container').append(window.util.fragment).fadeIn(ANIMATION_TIME);\n  };\n\n  const onTryBtnClick = () => {\n    const $removingElements = $('.registration__send-icon, .registration__message-text-wrapper');\n    const $form = $('.registration__form')[0];\n    const $startElements = $('.registration__form, .registration__title');\n\n    $removingElements.fadeOut(ANIMATION_TIME, () => {\n      $removingElements.remove();\n      $form.reset();\n      $startElements.fadeIn(ANIMATION_TIME);\n      $('.registration .container').removeAttr('style');\n    });\n  };\n\n  const setTryBtnCallback = () => {\n    $('.registration__further-actions').click(() => {\n      onTryBtnClick();\n    });\n  };\n\n  const showMessage = (elements, icon, addClass, messageText, furtherText) => {\n    icon.removeClass('registration__send-icon--progress')\n      .addClass(addClass)\n      .fadeIn(ANIMATION_TIME);\n\n    editAndPushElements(elements, messageText, furtherText);\n    setTryBtnCallback();\n  };\n\n  const onSendSuccess = () => {\n    const elements = setPrevElems();\n    const $icon = $('.registration__send-icon');\n\n    $icon.fadeOut(ANIMATION_TIME, () => {\n      showMessage(\n        elements,\n        $icon,\n        'registration__send-icon--success',\n        'Ваша заявка была успешно отправлена',\n        'Отправить ещё одну заявку'\n      );\n    });\n  };\n\n  const onSendError = () => {\n    const elements = setPrevElems();\n    const $icon = $('.registration__send-icon');\n\n    $icon.fadeOut(ANIMATION_TIME, () => {\n      showMessage(\n        elements,\n        $icon,\n        'registration__send-icon--error',\n        'Что-то пошло не так...',\n        'Попробовать ещё раз.'\n      );\n    });\n  };\n\n  const onSubmitSend = () => {\n    const $container = $('.registration .container');\n    const startHeight = $container.height();\n    const $startContent = $container.children();\n    const progressIcon = document.createElement('div');\n\n    $container.height(startHeight);\n    $startContent.fadeOut(ANIMATION_TIME);\n    $(progressIcon).attr('class', 'registration__send-icon registration__send-icon--progress');\n    $container.append(progressIcon);\n  };\n\n  const SendParam = {\n    URL: 'https://echo.htmlacademy.ru/',\n    METHOD: 'POST',\n    TIMEOUT: 5000,\n    ON_SUCCESS: onSendSuccess,\n    ON_ERROR: onSendError\n  };\n\n  const onFormSubmit = (sendParams) => {\n    const formData = $form.serializeArray();\n\n    $.ajax({\n      url: sendParams.URL,\n      method: sendParams.METHOD,\n      timeout: sendParams.TIMEOUT,\n      data: formData,\n      dataType: 'html',\n\n      success: sendParams.ON_SUCCESS,\n      error: sendParams.ON_ERROR\n    });\n  };\n\n  const validateForm = () => {\n    jQuery.validator.addMethod(\"checkMask\", (value, element) => {\n      return /^(\\s*)?(\\+)?([- _():=+]?\\d[- _():=+]?){10,14}(\\s*)?$/.test(value);\n    });\n\n    $form.validate({\n      errorElement: \"span\",\n      errorClass: \"registration__error-message\",\n      rules: {\n        name: {\n          required: true,\n          minlength: 3\n        },\n\n        phone: {\n          checkMask: true\n        }\n      },\n\n      messages: {\n        name: {\n          required: 'Пожалуйста, укажите Ваше имя',\n          minlength: 'Имя не может быть короче 3-х символов'\n        },\n\n        phone: {\n          required: 'Введите, пожалуйста, Ваш номер телефона',\n          checkMask: 'Введите правильный номер телефона'\n        }\n      }\n    });\n\n    $('.registration__input[name=\"phone\"]')\n      .mask(\"+7 (999) 999-99-99\", {\n        autoclear: false\n      });\n  };\n\n  const setSubmitCallback = () => {\n    $form.on('submit', (evt) => {\n      evt.preventDefault();\n\n      if ($('.registration__input[name=name]').val() !== '' && $('.registration__input[name=phone]').val() !== '') {\n        const invalidObj = $('.registration__form').validate().invalid;\n        const isObjElem = invalidObj[Object.keys(invalidObj)[0]];\n\n        if (!isObjElem) {\n          onSubmitSend();\n          onFormSubmit(SendParam);\n        }\n      }\n    });\n  };\n\n  validateForm();\n  setSubmitCallback();\n})();\n"],"file":"reg-form.js"}